<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pulse ‚Äî Log Forge</title>
    <link rel="stylesheet" href="assets/style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@300;400;500;600;700&family=Space+Grotesk:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <div class="app">
        <header class="header">
            <div class="header-brand">
                <div class="logo-icon">
                    <svg width="28" height="28" viewBox="0 0 28 28" fill="none">
                        <rect x="2" y="8" width="4" height="16" rx="1" fill="#00ff88" opacity="0.4"/>
                        <rect x="8" y="4" width="4" height="20" rx="1" fill="#00ff88" opacity="0.6"/>
                        <rect x="14" y="2" width="4" height="24" rx="1" fill="#00ff88" opacity="0.8"/>
                        <rect x="20" y="6" width="4" height="18" rx="1" fill="#00ff88"/>
                    </svg>
                </div>
                <h1>Pulse</h1>
                <span class="tag">log forge</span>
            </div>
            <div class="header-right">
                <button id="btn-mode-toggle" class="btn-mode" title="Toggle Advanced Mode">
                    <span class="mode-label">Simple</span>
                    <div class="mode-switch"><div class="mode-dot"></div></div>
                    <span class="mode-label">Advanced</span>
                </button>
            </div>
        </header>

        <main class="main">
            <!-- ===== Log Type ===== -->
            <section class="panel">
                <h2 class="panel-title">Log Type</h2>
                <p class="panel-desc">Choose which log format to generate.</p>
                <div class="logtype-grid">
                    <label class="logtype-card active" data-logtype="apache">
                        <input type="radio" name="log_type" value="apache" checked>
                        <div class="lt-inner"><div class="lt-icon">‚¨°</div><div class="lt-text"><strong>Apache</strong><span>access.log</span></div></div>
                    </label>
                    <label class="logtype-card" data-logtype="nginx">
                        <input type="radio" name="log_type" value="nginx">
                        <div class="lt-inner"><div class="lt-icon">‚ñ≤</div><div class="lt-text"><strong>Nginx</strong><span>access.log + timing</span></div></div>
                    </label>
                    <label class="logtype-card" data-logtype="iis">
                        <input type="radio" name="log_type" value="iis">
                        <div class="lt-inner"><div class="lt-icon">‚óÜ</div><div class="lt-text"><strong>IIS</strong><span>W3C Extended</span></div></div>
                    </label>
                    <label class="logtype-card" data-logtype="ssh">
                        <input type="radio" name="log_type" value="ssh">
                        <div class="lt-inner"><div class="lt-icon">‚ñ∏</div><div class="lt-text"><strong>SSH</strong><span>auth.log</span></div></div>
                    </label>
                    <label class="logtype-card" data-logtype="windows">
                        <input type="radio" name="log_type" value="windows">
                        <div class="lt-inner"><div class="lt-icon">‚äû</div><div class="lt-text"><strong>Windows Event</strong><span>Security.csv</span></div></div>
                    </label>
                    <label class="logtype-card" data-logtype="firewall">
                        <input type="radio" name="log_type" value="firewall">
                        <div class="lt-inner"><div class="lt-icon">‚óß</div><div class="lt-text"><strong>Firewall</strong><span>iptables syslog</span></div></div>
                    </label>
                </div>
            </section>

            <!-- ===== Scenarios ===== -->
            <section class="panel">
                <h2 class="panel-title">Attack Scenarios</h2>
                <p class="panel-desc" id="scenario-desc">Select which attack patterns to embed in the generated log.</p>

                <!-- ======== APACHE ======== -->
                <div class="scenario-group" id="scenarios-apache">
                    <div class="scenario-grid">
                        <div class="scenario-wrap">
                            <label class="scenario-card"><input type="checkbox" class="sc-check" value="lfi" checked>
                                <div class="card-inner"><div class="card-icon">üìÇ</div><div class="card-text"><strong>LFI</strong><span>Path traversal via <code>page.php?file=</code></span></div><div class="check-mark">‚úì</div></div>
                            </label>
                            <div class="adv-fields" style="display:none;">
                                <div class="adv-row"><label>Endpoint path</label><input type="text" class="adv-input" data-key="lfi_endpoint" value="/page.php" placeholder="/page.php"></div>
                                <div class="adv-row"><label>Parameter name</label><input type="text" class="adv-input" data-key="lfi_param" value="file" placeholder="file"></div>
                                <div class="adv-row"><label>Custom payloads <span class="adv-hint">one per line, leave empty for defaults</span></label><textarea class="adv-textarea" data-key="lfi_payloads" rows="4" placeholder="../../etc/passwd&#10;php://filter/convert.base64-encode/resource=index"></textarea></div>
                            </div>
                        </div>
                        <div class="scenario-wrap">
                            <label class="scenario-card"><input type="checkbox" class="sc-check" value="bruteforce" checked>
                                <div class="card-inner"><div class="card-icon">üîê</div><div class="card-text"><strong>HTTP Bruteforce</strong><span>Credential stuffing on <code>/account/login.php</code></span></div><div class="check-mark">‚úì</div></div>
                            </label>
                            <div class="adv-fields" style="display:none;">
                                <div class="adv-row"><label>Login endpoint</label><input type="text" class="adv-input" data-key="brute_endpoint" value="/account/login.php" placeholder="/account/login.php"></div>
                                <div class="adv-row"><label>Success status code</label><input type="number" class="adv-input" data-key="brute_success_code" value="302" placeholder="302"></div>
                            </div>
                        </div>
                        <div class="scenario-wrap">
                            <label class="scenario-card"><input type="checkbox" class="sc-check" value="webshell" checked>
                                <div class="card-inner"><div class="card-icon">üíÄ</div><div class="card-text"><strong>Webshell</strong><span>RCE via <code>.cache-img.php</code> in uploads</span></div><div class="check-mark">‚úì</div></div>
                            </label>
                            <div class="adv-fields" style="display:none;">
                                <div class="adv-row"><label>Shell path</label><input type="text" class="adv-input" data-key="shell_path" value="/uploads/products/.cache-img.php" placeholder="/uploads/products/.cache-img.php"></div>
                                <div class="adv-row"><label>Parameter name</label><input type="text" class="adv-input" data-key="shell_param" value="cmd" placeholder="cmd"></div>
                                <div class="adv-row"><label>Custom commands <span class="adv-hint">one per line, leave empty for defaults</span></label><textarea class="adv-textarea" data-key="shell_commands" rows="4" placeholder="whoami&#10;id&#10;cat /etc/passwd"></textarea></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ======== NGINX ======== -->
                <div class="scenario-group" id="scenarios-nginx" style="display:none;">
                    <div class="scenario-grid">
                        <div class="scenario-wrap">
                            <label class="scenario-card"><input type="checkbox" class="sc-check" value="lfi" checked>
                                <div class="card-inner"><div class="card-icon">üìÇ</div><div class="card-text"><strong>LFI</strong><span>Path traversal ‚Äî same BrightMall app, Nginx format</span></div><div class="check-mark">‚úì</div></div>
                            </label>
                            <div class="adv-fields" style="display:none;">
                                <div class="adv-row"><label>Endpoint path</label><input type="text" class="adv-input" data-key="lfi_endpoint" value="/page.php" placeholder="/page.php"></div>
                                <div class="adv-row"><label>Parameter name</label><input type="text" class="adv-input" data-key="lfi_param" value="file" placeholder="file"></div>
                                <div class="adv-row"><label>Custom payloads <span class="adv-hint">one per line</span></label><textarea class="adv-textarea" data-key="lfi_payloads" rows="4" placeholder=""></textarea></div>
                            </div>
                        </div>
                        <div class="scenario-wrap">
                            <label class="scenario-card"><input type="checkbox" class="sc-check" value="bruteforce" checked>
                                <div class="card-inner"><div class="card-icon">üîê</div><div class="card-text"><strong>HTTP Bruteforce</strong><span>POST flood ‚Äî Nginx response timing visible</span></div><div class="check-mark">‚úì</div></div>
                            </label>
                            <div class="adv-fields" style="display:none;">
                                <div class="adv-row"><label>Login endpoint</label><input type="text" class="adv-input" data-key="brute_endpoint" value="/account/login.php" placeholder="/account/login.php"></div>
                            </div>
                        </div>
                        <div class="scenario-wrap">
                            <label class="scenario-card"><input type="checkbox" class="sc-check" value="webshell" checked>
                                <div class="card-inner"><div class="card-icon">üíÄ</div><div class="card-text"><strong>Webshell</strong><span>RCE ‚Äî request timing reveals execution</span></div><div class="check-mark">‚úì</div></div>
                            </label>
                            <div class="adv-fields" style="display:none;">
                                <div class="adv-row"><label>Shell path</label><input type="text" class="adv-input" data-key="shell_path" value="/uploads/products/.cache-img.php"></div>
                                <div class="adv-row"><label>Parameter name</label><input type="text" class="adv-input" data-key="shell_param" value="cmd"></div>
                                <div class="adv-row"><label>Custom commands <span class="adv-hint">one per line</span></label><textarea class="adv-textarea" data-key="shell_commands" rows="4" placeholder=""></textarea></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ======== IIS ======== -->
                <div class="scenario-group" id="scenarios-iis" style="display:none;">
                    <div class="scenario-grid">
                        <div class="scenario-wrap">
                            <label class="scenario-card"><input type="checkbox" class="sc-check" value="lfi" checked>
                                <div class="card-inner"><div class="card-icon">üìÇ</div><div class="card-text"><strong>LFI</strong><span>File inclusion via <code>/Content/Page?view=</code> (ASP.NET)</span></div><div class="check-mark">‚úì</div></div>
                            </label>
                            <div class="adv-fields" style="display:none;">
                                <div class="adv-row"><label>URI Stem</label><input type="text" class="adv-input" data-key="lfi_endpoint" value="/Content/Page"></div>
                                <div class="adv-row"><label>Parameter name</label><input type="text" class="adv-input" data-key="lfi_param" value="view"></div>
                                <div class="adv-row"><label>Custom payloads <span class="adv-hint">one per line</span></label><textarea class="adv-textarea" data-key="lfi_payloads" rows="4" placeholder="..\\..\\..\\windows\\win.ini"></textarea></div>
                            </div>
                        </div>
                        <div class="scenario-wrap">
                            <label class="scenario-card"><input type="checkbox" class="sc-check" value="bruteforce" checked>
                                <div class="card-inner"><div class="card-icon">üîê</div><div class="card-text"><strong>HTTP Bruteforce</strong><span>POST flood on <code>/Account/Login</code></span></div><div class="check-mark">‚úì</div></div>
                            </label>
                            <div class="adv-fields" style="display:none;">
                                <div class="adv-row"><label>Login URI Stem</label><input type="text" class="adv-input" data-key="brute_endpoint" value="/Account/Login"></div>
                            </div>
                        </div>
                        <div class="scenario-wrap">
                            <label class="scenario-card"><input type="checkbox" class="sc-check" value="webshell" checked>
                                <div class="card-inner"><div class="card-icon">üíÄ</div><div class="card-text"><strong>Webshell</strong><span>ASHX handler: <code>cache-handler.ashx?c=</code></span></div><div class="check-mark">‚úì</div></div>
                            </label>
                            <div class="adv-fields" style="display:none;">
                                <div class="adv-row"><label>Handler path</label><input type="text" class="adv-input" data-key="shell_path" value="/Uploads/Products/cache-handler.ashx"></div>
                                <div class="adv-row"><label>Parameter name</label><input type="text" class="adv-input" data-key="shell_param" value="c"></div>
                                <div class="adv-row"><label>Custom commands <span class="adv-hint">one per line</span></label><textarea class="adv-textarea" data-key="shell_commands" rows="4" placeholder=""></textarea></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ======== SSH ======== -->
                <div class="scenario-group" id="scenarios-ssh" style="display:none;">
                    <div class="scenario-grid">
                        <div class="scenario-wrap">
                            <label class="scenario-card"><input type="checkbox" class="sc-check" value="ssh_bruteforce" checked>
                                <div class="card-inner"><div class="card-icon">üîê</div><div class="card-text"><strong>SSH Bruteforce</strong><span>Rapid <code>Failed password</code> flood against sshd</span></div><div class="check-mark">‚úì</div></div>
                            </label>
                            <div class="adv-fields" style="display:none;">
                                <div class="adv-row"><label>Target usernames <span class="adv-hint">one per line, leave empty for defaults</span></label><textarea class="adv-textarea" data-key="ssh_brute_users" rows="3" placeholder="root&#10;admin&#10;deploy"></textarea></div>
                                <div class="adv-row"><label>Compromised user</label><input type="text" class="adv-input" data-key="ssh_compromised_user" value="" placeholder="auto (random legit user)"></div>
                                <div class="adv-row"><label>Hostname</label><input type="text" class="adv-input" data-key="ssh_hostname" value="brightmall-web01"></div>
                            </div>
                        </div>
                        <div class="scenario-wrap">
                            <label class="scenario-card"><input type="checkbox" class="sc-check" value="ssh_spray">
                                <div class="card-inner"><div class="card-icon">üéØ</div><div class="card-text"><strong>Password Spray</strong><span>One password per round across many users, long delays</span></div><div class="check-mark">‚úì</div></div>
                            </label>
                            <div class="adv-fields" style="display:none;">
                                <div class="adv-row"><label>Spray target usernames <span class="adv-hint">one per line</span></label><textarea class="adv-textarea" data-key="ssh_spray_users" rows="3" placeholder=""></textarea></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ======== WINDOWS ======== -->
                <div class="scenario-group" id="scenarios-windows" style="display:none;">
                    <div class="scenario-grid">
                        <div class="scenario-wrap">
                            <label class="scenario-card"><input type="checkbox" class="sc-check" value="win_bruteforce" checked>
                                <div class="card-inner"><div class="card-icon">üîê</div><div class="card-text"><strong>Logon Bruteforce</strong><span>4625 flood ‚Üí 4624 success (RDP / SMB)</span></div><div class="check-mark">‚úì</div></div>
                            </label>
                            <div class="adv-fields" style="display:none;">
                                <div class="adv-row"><label>Target usernames <span class="adv-hint">one per line</span></label><textarea class="adv-textarea" data-key="win_brute_users" rows="3" placeholder="Administrator&#10;admin&#10;j.smith"></textarea></div>
                                <div class="adv-row"><label>Domain name</label><input type="text" class="adv-input" data-key="win_domain" value="NOVACORP"></div>
                                <div class="adv-row"><label>Computer name</label><input type="text" class="adv-input" data-key="win_hostname" value="NOVA-WEB01"></div>
                            </div>
                        </div>
                        <div class="scenario-wrap">
                            <label class="scenario-card"><input type="checkbox" class="sc-check" value="win_postexploit" checked>
                                <div class="card-inner"><div class="card-icon">‚ö†Ô∏è</div><div class="card-text"><strong>Post-Exploitation</strong><span>4688 suspicious processes ‚Üí 4720 user creation ‚Üí 4732 admin group ‚Üí 7045 malicious service</span></div><div class="check-mark">‚úì</div></div>
                            </label>
                            <div class="adv-fields" style="display:none;">
                                <div class="adv-row"><label>Compromised account</label><input type="text" class="adv-input" data-key="win_compromised_user" value="" placeholder="auto (random legit user)"></div>
                                <div class="adv-row"><label>Backdoor user to create</label><input type="text" class="adv-input" data-key="win_backdoor_user" value="svc_update"></div>
                                <div class="adv-row"><label>Malicious service name</label><input type="text" class="adv-input" data-key="win_svc_name" value="" placeholder="auto (random)"></div>
                                <div class="adv-row"><label>Custom process commands <span class="adv-hint">one per line ‚Äî format: process.exe arguments</span></label><textarea class="adv-textarea" data-key="win_custom_procs" rows="4" placeholder="cmd.exe /c whoami&#10;powershell.exe -ep bypass -c IEX(...)"></textarea></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ======== FIREWALL ======== -->
                <div class="scenario-group" id="scenarios-firewall" style="display:none;">
                    <div class="scenario-grid">
                        <div class="scenario-wrap">
                            <label class="scenario-card"><input type="checkbox" class="sc-check" value="fw_portscan" checked>
                                <div class="card-inner"><div class="card-icon">üîç</div><div class="card-text"><strong>Port Scan</strong><span>Sequential / stealth SYN scan from external IP</span></div><div class="check-mark">‚úì</div></div>
                            </label>
                            <div class="adv-fields" style="display:none;">
                                <div class="adv-row"><label>Target server IP</label><input type="text" class="adv-input" data-key="fw_target_ip" value="10.10.10.5"></div>
                                <div class="adv-row"><label>Port range <span class="adv-hint">e.g. 1-1024 or comma-separated</span></label><input type="text" class="adv-input" data-key="fw_scan_ports" value="" placeholder="auto (based on difficulty)"></div>
                            </div>
                        </div>
                        <div class="scenario-wrap">
                            <label class="scenario-card"><input type="checkbox" class="sc-check" value="fw_beacon" checked>
                                <div class="card-inner"><div class="card-icon">üì°</div><div class="card-text"><strong>C2 Beaconing</strong><span>Regular-interval callbacks to C2 server</span></div><div class="check-mark">‚úì</div></div>
                            </label>
                            <div class="adv-fields" style="display:none;">
                                <div class="adv-row"><label>C2 server IP</label><input type="text" class="adv-input" data-key="fw_c2_ip" value="" placeholder="auto (random from pool)"></div>
                                <div class="adv-row"><label>C2 port</label><input type="number" class="adv-input" data-key="fw_c2_port" value="" placeholder="auto (443, 8443, etc.)"></div>
                                <div class="adv-row"><label>Beacon interval (seconds)</label><input type="number" class="adv-input" data-key="fw_beacon_interval" value="" placeholder="auto (based on difficulty)"></div>
                                <div class="adv-row"><label>Jitter % (0-50)</label><input type="number" class="adv-input" data-key="fw_beacon_jitter" value="" placeholder="auto" min="0" max="50"></div>
                            </div>
                        </div>
                        <div class="scenario-wrap">
                            <label class="scenario-card"><input type="checkbox" class="sc-check" value="fw_exfil">
                                <div class="card-inner"><div class="card-icon">üì§</div><div class="card-text"><strong>Data Exfiltration</strong><span>Burst transfers to external IP</span></div><div class="check-mark">‚úì</div></div>
                            </label>
                            <div class="adv-fields" style="display:none;">
                                <div class="adv-row"><label>Exfil destination IP</label><input type="text" class="adv-input" data-key="fw_exfil_ip" value="" placeholder="auto (random C2 IP)"></div>
                                <div class="adv-row"><label>Exfil port</label><input type="number" class="adv-input" data-key="fw_exfil_port" value="" placeholder="auto (443, 22, etc.)"></div>
                            </div>
                        </div>
                    </div>
                </div>

            </section>

            <!-- ===== Config ===== -->
            <section class="panel">
                <h2 class="panel-title">Configuration</h2>
                <div class="config-grid">
                    <div class="config-item">
                        <label for="difficulty">Difficulty</label>
                        <select id="difficulty">
                            <option value="easy">Easy ‚Äî obvious patterns</option>
                            <option value="medium" selected>Medium ‚Äî mixed signals</option>
                            <option value="hard">Hard ‚Äî stealthy, low & slow</option>
                        </select>
                    </div>
                    <div class="config-item">
                        <label for="noise_lines">Noise Lines</label>
                        <input type="range" id="noise_lines" min="100" max="3000" value="500" step="50">
                        <output id="noise_lines_val">500</output>
                    </div>
                    <div class="config-item">
                        <label for="attacker_count">Attacker IPs</label>
                        <select id="attacker_count">
                            <option value="1" selected>1 attacker</option>
                            <option value="2">2 attackers</option>
                            <option value="3">3 attackers</option>
                        </select>
                    </div>
                    <div class="config-item">
                        <label for="time_span">Time Span</label>
                        <select id="time_span">
                            <option value="1">1 hour</option>
                            <option value="3">3 hours</option>
                            <option value="6" selected>6 hours</option>
                            <option value="12">12 hours</option>
                            <option value="24">24 hours</option>
                        </select>
                    </div>

                    <!-- Advanced: custom attacker IPs -->
                    <div class="config-item adv-only" style="display:none;">
                        <label for="custom_attacker_ips">Attacker IPs <span class="adv-hint">one per line, leave empty for random</span></label>
                        <textarea id="custom_attacker_ips" class="adv-textarea" rows="3" placeholder="185.156.73.54&#10;45.155.205.233"></textarea>
                    </div>
                </div>
            </section>

            <!-- ===== Actions ===== -->
            <div class="action-row">
                <button id="btn-generate" class="btn-primary">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="5,3 19,12 5,21"/></svg>
                    Generate Log
                </button>
                <button id="btn-preview" class="btn-secondary">Preview</button>
            </div>

            <!-- ===== Output ===== -->
            <section class="panel output-panel" id="output-panel" style="display:none;">
                <h2 class="panel-title">Output</h2>
                <div class="output-stats" id="output-stats"></div>
                <div class="output-actions" id="output-actions"></div>
                <div id="preview-section" style="display:none;">
                    <div class="preview-block"><h3>Log Preview <span class="preview-label">first 20 lines</span></h3><pre id="preview-head"></pre></div>
                    <div class="preview-block"><h3>Log Tail <span class="preview-label">last 10 lines</span></h3><pre id="preview-tail"></pre></div>
                </div>
                <div id="answer-section" style="display:none;">
                    <button id="btn-toggle-answers" class="btn-answer-toggle">üëÅ Show Answer Key</button>
                    <div id="answer-content" class="answer-content" style="display:none;"><pre id="answer-json"></pre></div>
                </div>
            </section>
        </main>

        <footer class="footer"><span>Pulse Log Forge ‚Äî for blue team training only</span></footer>
    </div>

    <script src="assets/app.js"></script>
</body>
</html>
